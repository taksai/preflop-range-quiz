## プロジェクト概要
- 目的: `hand_range.csv` に定義された各ハンドの推奨オープン人数 (Players) と色分け (Color) を暗記できるシングルページ Web アプリを作成する。
- ゴール: ハンドがランダムに提示され、ユーザーが `Players` に対応するボタンを押すことで即時に正誤が分かり、ミスの多いハンドがより頻繁に出題されるようにする。

## データソース
- ファイル: `/Users/takumasaito/workspace/pk/preflop-range-quiz/hand_range.csv`
- カラム:
  - `Hand`: ハンド表記 (例: `AKs`)
  - `Color`: UI の配色タグ (例: `紺`, `赤`, `グレー`)
  - `Players`: 推奨オープン可能人数 (0〜10)
  - `misses`: 重み付け・ミス回数。初期値 1。ユーザーのミスごとに +1 する。

## UI および操作要件
- 画面構成:
  - ハンド表示カード: 現在の `Hand` を大きく表示。
  - 回答ボタン群: `Players` 値 (0〜10 の整数) をラベルにしたボタンを横2列で並べる。
    - 表示中ハンドの `Color` を、回答ボタンの背景色に反映させる (見やすさ優先でトーンは調整可)。
  - 結果表示: ボタン押下後に正誤を表示し、正解の `Players` と `Color` を明示。
  - ステータス表示:
    - 累計ミス数
    - 現在のハンドの `misses` 値
    - 当該ハンドを最後にミスした日時 (保存方式決定後に追加)
  - `Next` または「次の問題へ」ボタンで次の出題に遷移。
- レスポンシブ対応: PC/モバイル双方で利用できる 1 カラム構成を想定。

## クイズフロー
1. 重み付き乱数で次に出題するハンドを選択 (`misses` を重みとして使用)。
2. 画面に `Hand` を表示し、0〜10 の `Players` ボタンを提示。（4と6はない）
3. ユーザーがボタンを押すと即座に正誤判定:
   - 正解: 「正解」表示。`misses` 変更なし。
   - 不正解:
     - 「不正解」表示。正しい `Players` と `Color` を提示。
     - グローバル `misses` カウンタを +1。
     - 対象ハンドの `misses` を +1 (詳細は後述)。
4. 結果表示後に「次へ」ボタンを有効化し、押下で再びステップ1へ。

## ミス処理と出題重み
- `misses` は「そのハンドをどれだけ間違えたか」を表す整数で、初期値 1。
- ハンド選択時の重み = 現在の `misses` 値。そのため `misses = 2` のハンドは初期状態 (1) のハンドの 2 倍出題されやすい。
- 不正解時の処理:
  1. 表示中ハンドの `misses` を +1 (メモリおよび永続化層)。
  2. ミス数 UI (累計・個別) を更新。
- 正解時は `misses` を変更しない (要望なしのため現状維持)。必要であれば将来的に「正解で重みを戻す」等の設定を追加できるよう設計しておく。

## 永続化・データ管理
- クライアント: 起動時に `hand_range.csv` を読み込み、メモリ上に `Hand` オブジェクト配列を保持 (CSV は参照専用)。
- 永続化方針: **ローカルストレージだけで完結**。
  - ブラウザ内に JSON を保持して `misses` を更新する方式。実装コストが低く、ネットワークやファイル書き込みの権限が不要。
  - ブラウザごと・端末ごとに学習状況が分かれる点は許容する。
  - CSV は更新しないためファイル保存操作は不要。再読み込み時に CSV の初期値とローカルストレージの差分をマージして出題に使用する。
- 将来的に共有・同期が必要になった場合は API 化や外部ストレージを検討する。

## 技術スタック (想定)
- フロントエンド: React + Vite などの軽量構成 (ブラウザ完結)。
- 状態管理: React Hooks (必要であれば Zustand/Redux)。
- CSV 読み込み: `papaparse` 等のパーサーを使用。
- 永続化:
  - ローカルのみであればブラウザの File System Access API で CSV 更新、または JSON 保存。
  - 共有環境を視野に入れる場合は簡易バックエンド (Node/Express) を別途用意し PUT API で `misses` を更新する。

## テレメトリとテスト
- ローカルストレージに各セッションのミス履歴と日付を保持して自己学習の進捗を確認できるようにする (任意)。
- 単体テスト: 重み付きランダム選択ロジック、CSV 更新ロジック、ミス処理の副作用を Jest などで検証。


